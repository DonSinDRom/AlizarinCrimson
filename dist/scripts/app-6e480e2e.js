"use strict";var app=angular.module("trigger",["angular-loading-bar","ngAnimate","ngCookies","ngTouch","ngSanitize","ngMaterial","btford.socket-io","luegg.directives","angularMoment","ngTimezone","ngMdIcons","cfp.hotkeys","vs-repeat","pascalprecht.translate","ngAudio"]);app.config(["$mdThemingProvider",function(t){t.theme("default").primaryPalette("teal").accentPalette("orange")}]).config(["cfpLoadingBarProvider",function(t){t.includeSpinner=!1}]),app.run(["$timezone","angularMomentConfig",function(t,a){a.preprocess="utc",a.timezone=t.getName()}]),app.run(["$rootScope","Client",function(t,a){t.load={signed:!1,welcome:!1,playlist:!1,channel:!1},t.title="Trigger",t.userId=0;var e=new Date;t.timezoneOffset=e.getTimezoneOffset(),a.init(location.host)}]),angular.module("trigger").controller("UserCtrl",["$scope","$rootScope","Client","$mdToast","User",function(t,a,e,s,n){function i(){}var o=localStorage.getItem("username"),r=localStorage.getItem("password");n.login(o,r),t.user={},t.toastPosition={bottom:!1,top:!0,left:!1,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(a){return t.toastPosition[a]}).join(" ")},t.$watch(function(){return a.load.signed},function(){a.load.signed===!0&&e.getUser({id:a.userId},function(s){void 0===e.user.g&&a.userId===e.user.id&&(e.user.g=s.g),s.karma=s.p.length-s.n.length,s.vote=void 0;for(var n in s.p)if(s.p[n].vid===e.user.id){s.vote="plus";break}for(var n in s.n)if(s.n[n].vid===e.user.id){s.vote="minus";break}t.user=s,t.$digest()}),t.load.signed=a.load.signed},!0),t.$watch(function(){return a.userId},function(){var s=a.userId;0===s&&(s="0"),e.getUser({id:s},function(a){a.karma=a.p.length-a.n.length,a.vote=void 0;for(var s in a.p)if(a.p[s].vid===e.user.id){a.vote="plus";break}for(var s in a.n)if(a.n[s].vid===e.user.id){a.vote="minus";break}console.log(a),a.pic||(a.pic="/assets/images/ear.png");var n=new Image;n.src=a.pic,n.onerror=function(){a.pic="/assets/images/ear.png"},t.user=a,t.$digest()})},!0),t.userVoteDown=function(a){var s=-1;"minus"===t.user.vote&&(s=0),e.adduservote({v:s,id:a},i),0===s?(t.user.vote="",t.user.karma++):(t.user.vote="minus",t.user.karma--)},t.userVoteUp=function(a){var s=1;"plus"===t.user.vote&&(s=0),e.adduservote({v:s,id:a},i),0===s?(t.user.vote="",t.user.karma--):(t.user.vote="plus",t.user.karma++)},t.avatarUrl="",t.previewAvatar=function(){var a=new Image;a.src=t.avatarUrl,a.onload=function(){t.user.pic=t.avatarUrl,t.save=!0},a.onerror=function(){s.show(s.simple().content("Can't find image! URL is incorrect!").position(t.getToastPosition()).hideDelay(3e3))}},t.edit=!1,t.save=!1,t.editAvatar=function(){t.edit=t.edit===!0?!1:!0},t.saveAvatar=function(){e.updateUserData({pic:t.avatarUrl}),t.edit=!1,t.save=!1,s.show(s.simple().content("Your avatar is changed! ^_^").position(t.getToastPosition()).hideDelay(3e3))}}]),angular.module("trigger").controller("UploadsCtrl",["$scope","$rootScope","Client",function(t,a,e){function s(a){moment.utc(t.date).format()>moment.utc(a.tt).format()&&(t.date=a.tt),t.tracks.push(a)}function n(a){e.getUser(a,function(a){for(var e in a)s(a[e]);t.$digest()})}function i(t,a){return new Date(t.getTime()+6e4*a)}t.tracks=[],t.date=moment(),t.data={id:a.userId,uplshift:0},t.$watch(function(){return a.load.signed},function(){a.load.signed===!0&&n(t.data),t.load.signed=a.load.signed},!0),t.loadMore=function(){var e={utc:t.date,offset:-1*a.timezoneOffset},s=new Date(t.date);e.utc=i(s,e.offset),t.data.uplshift=e.utc,n(t.data)}}]),angular.module("trigger").controller("UploadCtrl",function(){}),angular.module("trigger").controller("SettingsCtrl",["$scope","Client","md5","$mdToast",function(t,a,e,s){t.gender=!a.user.g,t.changeGender=function(){a.user.g=t.gender===!0?!1:!0,a.updateUserData({g:!t.gender})},t.toastPosition={bottom:!1,top:!0,left:!1,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(a){return t.toastPosition[a]}).join(" ")},t.oldPassword="",t.newPassword="",t.newPasswordFix="",t.changePassword=function(){if(t.newPassword.length>0&&t.newPassword===t.newPasswordFix){var n=e.createHash(t.oldPassword),i=e.createHash(t.newPassword);a.changepass(n,i,function(a){console.log(a),s.show(a.ok?s.simple().content("Все получилось!").position(t.getToastPosition()).hideDelay(3e3):s.simple().content("Что-то пошло не так!").position(t.getToastPosition()).hideDelay(3e3))})}else s.show(s.simple().content("Пароли не совпадают!").position(t.getToastPosition()).hideDelay(3e3))}}]),angular.module("trigger").controller("PlusesCtrl",["$scope","$rootScope","Client",function(t,a,e){function s(a){null===a.tt&&(a.tt=moment().utc().format()),moment.utc(t.date).format()>moment.utc(a.tt).format()&&(t.date=a.tt),t.tracks.push(a)}function n(a){e.getUser(a,function(a){for(var e in a)s(a[e]);t.$digest()})}t.tracks=[],t.date=moment(),t.data={id:a.userId,uplshift:0,p:!0},t.$watch(function(){return a.load.signed},function(){a.load.signed===!0&&n(t.data),t.load.signed=a.load.signed},!0),t.loadMore=function(){var e={utc:t.date,offset:-1*a.timezoneOffset},s=new Date(t.date);e.utc=s,t.data.uplshift=e.utc,n(t.data)}}]),angular.module("trigger").controller("PlaylistCtrl",["$scope","$rootScope","$mdSidenav","Client","socket","$interval","hotkeys","Channel","User",function(t,a,e,s,n,i,o,r,c){function l(){for(var a=t.playlist.length,e=0;a>e;e++){for(var s in t.playlist[e].p)if(t.playlist[e].p[s].vid===t.user.id){t.playlist[e].vote=t.user.w;break}for(var s in t.playlist[e].n)if(t.playlist[e].n[s].vid===t.user.id){t.playlist[e].vote=-t.user.w;break}}for(var s in t.track.p)if(t.track.p[s].vid===t.user.id){t.track.vote=t.user.w;break}for(var s in t.track.n)if(t.track.n[s].vid===t.user.id){t.track.vote=-t.user.w;break}}function d(a){var a=a;a.vote=0,a.src="img/nocover.png";for(var e=t.playlist.length,s=!1,n=0;e>n;n++)if(t.playlist[n].id===a.id){s=!0;break}if(s===!1){if(t.isAuth===!0){for(var i in a.p)if(a.p[i].vid===t.user.id){a.vote=t.user.w;break}for(var i in a.n)if(a.n[i].vid===t.user.id){a.vote=-1*t.user.w;break}}a.ut=g(a.ut),t.playlist.push(a)}}function g(t){var e=new Date(t);return u(e,a.timezoneOffset)}function u(t,a){return new Date(t.getTime()+6e4*a)}function m(a){a.chid=t.channel.id,n.emit("vote",a)}t.isAuth=!1,t.playlist=[],t.track={},t.channel={},t.channel.name="Channel",t.channel.id=0,t.channel.ct=0,t.user={},t.user.name="",t.user.id=0,t.user.w=0,t.$watch(c.getId,function(a){t.user.id=a}),t.$watch(c.getUsername,function(a){t.user.name=a}),t.$watch(c.getUservote,function(a){t.user.w=a}),t.$watch(r.getId,function(a){t.channel.id=a}),t.$watch(r.getCurrent,function(a){t.track=a}),t.$watch(r.getProgress,function(a){t.channel.ct=a,void 0!==t.track&&t.starTimer(t.channel.ct,t.track.tt)}),t.$watch(r.getPlaylist,function(a){t.playlist=a}),t.$watch(c.isAuth,function(a){t.isAuth=a,a===!0&&l()}),o.bindTo(t).add({combo:"alt+up",description:"Up current track",allowIn:["INPUT","SELECT","TEXTAREA"],callback:function(){m({id:t.track.id,v:t.user.w}),event.preventDefault(),console.log("alt+up")}}).add({combo:"alt+down",description:"Down current track",allowIn:["INPUT","SELECT","TEXTAREA"],callback:function(){m({id:t.track.id,v:-1*t.user.w}),event.preventDefault(),console.log("alt+down")}}),t.reverse=0;var p=window.innerWidth>0?window.innerWidth:screen.width;960>=p&&(t.reverse=1),t.toggleLeft=function(){e("left").toggle()},t.toggleRight=function(){e("right").toggle()},n.on("newcurrent",function(e){if(t.isAuth===!0){for(var s in e.track.p)if(e.track.p[s].vid===t.user.id){e.track.vote=t.user.w;break}for(var s in e.track.n)if(e.track.n[s].vid===t.user.id){e.track.vote=-t.user.w;break}}e.track.ut=g(e.track.ut),t.stopTimer(),t.starTimer(0,e.track.tt),t.track=e.track,a.title="! "+e.track.a+" - "+e.track.t+" @ Trigger";for(var n=t.playlist.length,i=0;n>i;i++)if(t.playlist[i].id===e.tid||t.playlist[i].id===e.track.id){t.playlist.splice(i,1);break}}),n.on("uptr",function(a){if(a.t.id===t.track.id){if(t.isAuth===!0){for(var e in a.t.p)if(a.t.p[e].vid===t.user.id){a.t.vote=t.user.w;break}for(var e in a.t.n)if(a.t.n[e].vid===t.user.id){a.t.vote=-1*t.user.w;break}}a.t.ut=g(a.t.ut),t.track=a.t}else{for(var s,n=t.playlist.length,i=0;n>i;i++)if(t.playlist[i].id===a.t.id){s=i,a.t.ut=g(a.t.ut),t.playlist[i]=a.t;break}if(t.isAuth===!0){for(var e in a.t.p)if(a.t.p[e].vid===t.user.id){a.t.vote=t.user.w;break}for(var e in a.t.n)if(a.t.n[e].vid===t.user.id){a.t.vote=-1*t.user.w;break}}}}),n.on("addtrack",function(t){d(t.track)}),n.on("removetrack",function(a){for(var e=t.playlist.length,s=0;e>s;s++)if(t.playlist[s].id===a.tid){t.playlist.splice(s,1);break}}),t.voteUp=function(a){var e=window.innerWidth>0?window.innerWidth:screen.width,s=!1;960>=e&&(s=!0),m(s===!0?this.track.vote===-t.user.w?{id:a,v:0}:{id:a,v:-t.user.w}:this.track.vote===t.user.w?{id:a,v:0}:{id:a,v:t.user.w})},t.voteDown=function(a){var e=window.innerWidth>0?window.innerWidth:screen.width,s=!1;960>=e&&(s=!0),m(s===!0?this.track.vote===t.user.w?{id:a,v:0}:{id:a,v:t.user.w}:this.track.vote===-t.user.w?{id:a,v:0}:{id:a,v:-t.user.w})};var k,h=0;t.progress=0,t.starTimer=function(a,e){h=a,k=i(function(){t.progress=(h/e*100).toFixed(2),h++},1e3)},t.stopTimer=function(){angular.isDefined(k)&&(i.cancel(k),k=void 0,t.progress=0)}}]),angular.module("trigger").controller("OnlineCtrl",["$scope","socket","Channel",function(t,a,e){t.users=[],t.$watch(e.getUsers,function(a){t.users=a}),a.on("offuser",function(a){for(var e in t.users)t.users[e].id===a.uid&&t.users.splice(e,1)}),a.on("newuser",function(a){var e={id:a.uid,n:a.n,a:a.a};t.users.push(e)}),a.on("usupd",function(a){for(var e in t.users)t.users[e].id===a.uid&&(t.users[e].a=a.a)})}]),angular.module("trigger").controller("MinusesCtrl",["$scope","$rootScope","Client",function(t,a,e){function s(a){null===a.tt&&(a.tt=moment().utc().format()),moment.utc(t.date).format()>moment.utc(a.tt).format()&&(t.date=a.tt),t.tracks.push(a)}function n(a){e.getUser(a,function(a){for(var e in a)s(a[e]);t.$digest()})}t.tracks=[],t.data={id:a.userId,uplshift:0,p:!1},t.$watch(function(){return a.load.signed},function(){a.load.signed===!0&&n(t.data),t.load.signed=a.load.signed},!0),t.loadMore=function(){var a={utc:t.date,offset:0},e=new Date(t.date);a.utc=e,t.data.uplshift=a.utc,n(t.data)}}]),angular.module("trigger").controller("LoginCtrl",["$scope","$rootScope","$mdDialog","md5","Client","$mdToast","User",function(t,a,e,s,n,i,o){t.user={name:"",password:"",remember:!1},t.toastPosition={bottom:!1,top:!0,left:!1,right:!0},t.getToastPosition=function(){return Object.keys(t.toastPosition).filter(function(a){return t.toastPosition[a]}).join(" ")},t.$watch(o.getData,function(a){console.log("getData: ",a),a&&a.error?i.show(i.simple().content(a.error).position(t.getToastPosition()).hideDelay(3e3)):a&&a.user&&(t.user.remember===!0&&(localStorage.setItem("username",t.user.name),localStorage.setItem("password",s.createHash(t.user.password))),i.show(i.simple().content("Welcome, "+a.user.n).position(t.getToastPosition()).hideDelay(3e3)),e.hide())}),t.login=function(){""===t.user.name?o.login("DonSinDRom",s.createHash("3a12a6")):o.login(t.user.name,s.createHash(t.user.password))},t.recoverPassword=function(){},t.hide=function(){e.hide()}}]),angular.module("trigger").controller("HistoryCtrl",["$scope","$rootScope","Client","socket",function(t,a,e,s){function n(a){if(t.load.signed===!0){for(var s in a.p)if(a.p[s].vid===e.user.id){a.vote=e.user.w;break}for(var s in a.n)if(a.n[s].vid===e.user.id){a.vote=-1*e.user.w;break}}t.tracks.push(a)}function i(t){s.emit("gethistory",{chid:1,s:t.shift,a:t.artist,t:t.title,top:t.top,g:t.gold,v:t.topType},function(t){console.log("gethistory",t);for(var a in t)n(t[a])})}function o(t,a){return new Date(t.getTime()+6e4*a)}t.tracks=[],t.data={shift:0,artist:"",title:"",gold:!1,top:!1,topType:!1},t.$watch(function(){return a.load.signed},function(){t.load.signed=a.load.signed},!0),t.showHistory=function(){i(t.data)},t.newHistory=function(){t.tracks=[],t.data.shift=0,i(t.data)},t.loadMore=function(){var e={utc:t.tracks[t.tracks.length-1].tt,offset:-1*a.timezoneOffset},s=new Date(t.tracks[t.tracks.length-1].tt);e.utc=o(s,e.offset),t.data.shift=e.utc,console.log(t.tracks.length,t.data.shift),i(t.data)}}]),angular.module("trigger").controller("DemocracyCtrl",["$scope","Channel",function(t,a){t.data={selectedIndex:1},t.description="",t.$watch(a.getDescription,function(a){t.description=a}),t.next=function(){t.data.selectedIndex=Math.min(t.data.selectedIndex+1,2)},t.previous=function(){t.data.selectedIndex=Math.max(t.data.selectedIndex-1,0)}}]),angular.module("trigger").controller("ConsoleCtrl",["$scope","$rootScope","$interval","$timeout","$mdDialog","$mdBottomSheet","Client","socket","Channel","User",function(t,a,e,s,n,i,o,r,c,l){function d(t,a){t.hide=function(){a.hide()}}t.users={listeners:0,active:0},t.$watch(c.getListeners,function(a){t.users.listeners=a}),t.$watch(c.getActiveUsers,function(a){t.users.active=a}),t.user={name:"%username%",uplim:0},t.$watch(l.isAuth,function(a){t.load.signed=a}),t.$watch(l.getLimit,function(a){t.user.uplim=a}),t.$watch(l.getUsername,function(a){t.user.name=a}),localStorage.getItem("theme")&&void 0!==localStorage.getItem("theme")&&localStorage.getItem("theme").length>0&&document.body.setAttribute("theme",localStorage.getItem("theme")),t.data=function(){document.body.style.webkitTransform="rotateY(180deg)"===document.body.style.webkitTransform?"rotateY(0deg)":"rotateY(180deg)",console.log("data",o)},t.changeTheme=function(){var a=document.body.getAttribute("theme");"dark"===a?(document.body.setAttribute("theme","light"),t.load.signed===!0&&localStorage.setItem("theme","light")):(document.body.setAttribute("theme","dark"),t.load.signed===!0&&localStorage.setItem("theme","dark"))},t.showLoginModal=function(t){n.show({controller:d,templateUrl:"components/login/login.html",targetEvent:t})},d.$inject=["$scope","$mdDialog"],t.openUploadBar=function(a){t.alert="",i.show({templateUrl:"components/upload/upload.html",controller:"UploadCtrl",targetEvent:a}).then(function(a){t.alert=a.name+" clicked!"})}}]),angular.module("trigger").controller("ChatCtrl",["$scope","$rootScope","Client","socket","hotkeys",function(t,a,e,s,n){function i(){if(t.settings.tink===!0){var a=new Audio;a.canPlayType("audio/ogg")?(a.src="http://trigger.fm/sounds/tink.ogg",a.play()):(a.src="http://trigger.fm/sounds/tink.mp3",a.play())}}function o(a){s.emit("getchat",a,function(a){for(var e=!1,s=a.m,n=g(),o=d(s,n),r=o.length,c=v.length,l=0;r>l;l++){o[l].m=u(o[l].m);for(var p=0;c>p;p++)if(o[l].m.replace(v[p][0],"")!==o[l].m){if(2>p){o[l].m=t.settings.img!==!0?o[l].m.replace(v[p+2][0],v[p+2][1]):o[l].m.replace(v[p][0],v[p][1]);break}o[l].m=o[l].m.replace(v[p][0],v[p][1])}var k=m(o[l]);k&&(o[l].type=k,e=!0)}e&&i(),t.messages=o})}function r(a){s.emit("getchat",a,function(a){for(var e=a.m,s=e.length,n=v.length,i=0;s>i;i++){e[i].m=u(e[i].m);for(var o=0;n>o;o++)if(e[i].m.replace(v[o][0],"")!==e[i].m){if(2>o){e[i].m=t.settings.img!==!0?e[i].m.replace(v[o+2][0],v[o+2][1]):e[i].m.replace(v[o][0],v[o][1]);break}e[i].m=e[i].m.replace(v[o][0],v[o][1])}var r=m(e[i]);r&&(e[i].type=r),c(e[i])}l()})}function c(t){f.push(t)}function l(){t.messages=f.concat(t.messages),f=[]}function d(t,a){var e=t.concat(a);return e=e.sort(function(t,a){return new Date(t.t)-new Date(a.t)})}function g(){for(var t=sessionStorage.length,a=[],e=0;t>e;e++){var s=sessionStorage.key(e),n=sessionStorage.getItem(s);s.indexOf("private")>-1&&a.push(JSON.parse(n))}return a}function u(t){if(t.indexOf("/track")>-1){var a=/\/track(\w*)/gim,e=a.exec(t);return e.input.replace(e[0],'&nbsp;<a track-id="'+e[1]+'" ng-click="focusTrack('+e[1]+')">'+e[0]+"</a>&nbsp;")}return t}function m(t){return t.m.indexOf("&gt;&gt;"+e.user.n)>-1?"private":t.m.indexOf("&gt;"+e.user.n)>-1?"personal":void 0}function p(){document.querySelector("#chatInput").focus()}function k(a){if(s.emit("sendmessage",{m:a}),a){for(var e=t.message.split(" "),n=[],i=0;i<e.length;i++)e[i].indexOf(">")>-1&&n.push(e[i]);t.message=n.join(" ")+" "}}function h(t){for(var a=t.split(" "),e=[],s=[],n=0;n<a.length;n++)a[n].indexOf(">")>-1?e.push(a[n]):s.push(a[n]);return[e,s]}function _(){var t="";return window.getSelection?t=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(t=document.selection.createRange().text),t}n.bindTo(t).add({combo:"esc",description:"Clear chat",allowIn:["INPUT","SELECT","TEXTAREA"],callback:function(){t.message="",event.preventDefault()}}),t.message="",t.messages=[],t.temp=[],t.settings={tink:!0,img:!0},t.data={shift:0,id:1},t.isChatExtended=!1,t.showOnline=!1,t.setOnline=function(){t.showOnline=t.showOnline===!0?!1:!0};var v=[];v[0]=[],v[0][0]=/(http:\/\/[\w\-\.]+\.[a-zA-Z]{2,3}(?:\/\S*)?(?:[\w])+\.(?:jpg|png|gif|jpeg|bmp))/gim,v[0][1]='&nbsp;<a href="$1" target="_blank"><img src="$1" /></a>&nbsp;',v[1]=[],v[1][0]=/(https:\/\/[\w\-\.]+\.[a-zA-Z]{2,3}(?:\/\S*)?(?:[\w])+\.(?:jpg|png|gif|jpeg|bmp))/gim,v[1][1]='&nbsp;<a href="$1" target="_blank"><img src="$1" /></a>&nbsp;',v[2]=[],v[2][0]=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim,v[2][1]='&nbsp;<a href="$1" target="_blank">$1</a>&nbsp;',v[3]=[],v[3][0]=/(^|[^\/])(www\.[\S]+(\b|$))/gim,v[3][1]='&nbsp;<a href="http://$1" target="_blank">$1</a>&nbsp;',v[4]=[],v[4][0]=/([\w\-\d]+\@[\w\-\d]+\.[\w\-\d]+)/gim,v[4][1]='&nbsp;<a href="mailto:$1">$1</a>&nbsp;',v[5]=[],v[5][0]="!!!!!!",v[5][1]="я идиот убейте меня кто нибудь! !!!!",v[6]=[],v[6][0]="))))))))))",v[6][1]='<font color="pink">недавно я познакомился с мальчиком, у него такие голубые глаза и член который еле помещается в мою... кажется я не туда пишу</font> ',v[7]=[],v[7][0]="NO.",v[7][1]='&lt;img src="/assets/images/nocover.png" style="object-fit: contain;"/&gt;',"false"===localStorage.getItem("tink")&&(t.settings.tink=!1),"false"===localStorage.getItem("img")&&(t.settings.img=!1),t.setTink=function(){t.settings.tink===!0?localStorage.setItem("tink",!0):localStorage.setItem("tink",!1)},t.setImg=function(){t.settings.img===!0?localStorage.setItem("img",!0):localStorage.setItem("img",!1)};var f=[];t.$watch(function(){return a.load.signed},function(){a.load.signed===!0?(v[8]=[],v[8][0]="&gt;"+e.user.n,v[8][1]='<span class="reference">&gt;'+e.user.n+"</span>&nbsp;",v[9]=[],v[9][0]='&gt;<span class="reference">&gt;'+e.user.n+"</span>&nbsp;",v[9][1]='<span class="reference">&gt;&gt;'+e.user.n+"</span>&nbsp;",o(t.data),s.on("message",function(a){var e=m(a);e?(console.log("messages",a),a.type=e,i(),"private"===a.type&&sessionStorage.setItem("private"+a.t,JSON.stringify(a))):a.m.indexOf("&gt;&gt;")>-1&&sessionStorage.setItem("private"+a.t,JSON.stringify(a)),a.m=u(a.m);for(var s=v.length,n=0;s>n;n++)if(a.m.replace(v[n][0],"")!==a.m){if(2>n){a.m=t.settings.img!==!0?a.m.replace(v[n+2][0],v[n+2][1]):a.m.replace(v[n][0],v[n][1]);break}a.m=a.m.replace(v[n][0],v[n][1])}t.messages.push(a)})):(t.message="",t.messages=""),t.load.signed=a.load.signed},!0),t.sendMessage=function(){this.message&&(k(t.message),t.isChatExtended=!1)},t.addNick=function(a){var e=t.message;e=e.indexOf(">"+a)>-1?e.indexOf(">>"+a)>-1?t.message.replace(">>"+a+" ",">"+a+" "):t.message.replace(">"+a+" ",">>"+a+" "):">"+a+" "+t.message,t.message=e,p()},t.loadMore=function(){t.data.shift=t.messages[0].t,r(t.data)},t.setBold=function(){p();var a=_(),e=[];e[0]="",e[1]="";var s="";a.length<1?s=h(t.message):(e[0]=t.message.substr(0,t.message.indexOf(a)),e[1]=t.message.substr(t.message.indexOf(a)+a.length,t.message.length),s=h(a));var n=s[0].join(" "),i=s[1].join(" "),o="";n.length>0&&(o=" "),t.message=e[0]+n+o+"<b>"+i+"</b>"+e[1]},t.setIrony=function(){p();var a=_(),e=[];e[0]="",e[1]="";var s="";a.length<1?s=h(t.message):(e[0]=t.message.substr(0,t.message.indexOf(a)),e[1]=t.message.substr(t.message.indexOf(a)+a.length,t.message.length),s=h(a));var n=s[0].join(" "),i=s[1].join(" "),o="";n.length>0&&(o=" "),t.message=e[0]+n+o+'<span class="irony">'+i+"</span>"+e[1]},t.checkMessage=function(){t.isChatExtended=t.message.length>=240?!0:!1}}]),angular.module("trigger").controller("AppCtrl",["$scope","$rootScope","$timeout","$mdSidenav","hotkeys","Client","ngAudio","User",function(t,a,e,s,n,i,o,r){t.sound=o.load("http://trigger.fm/stream/mainmp3"),t.play=!1,t.volume=50,t.start=function(){t.play=!0,t.sound.play()},"true"===localStorage.getItem("play")&&e(function(){t.start()},5e3);var c=localStorage.getItem("username"),l=localStorage.getItem("password");""!==localStorage.getItem("password")&&e(function(){r.login(c,l)},5e3),t.togglePlay=function(){t.play=!t.play,t.play===!0?(localStorage.setItem("play",!0),t.sound.play()):(localStorage.setItem("play",!1),t.sound.pause())},localStorage.getItem("volume")&&localStorage.getItem("volume").length>-1?t.volume=localStorage.getItem("volume"):localStorage.setItem("volume",t.volume),t.changeVolume=function(a){localStorage.setItem("volume",a),t.sound.volume=a/100},n.bindTo(t).add({combo:"shift+space",description:"Mute current track",allowIn:["INPUT","SELECT","TEXTAREA"],callback:function(){t.togglePlay(),event.preventDefault()}}),t.trackToChat=function(t){var a=document.querySelector("#chatInput");a&&(a.value+="/track"+t+" ",a.focus())},t.infoTab=2,t.$watch(function(){return a.load.signed},function(){a.load.signed===!0&&(t.infoTab=0),t.load.signed=a.load.signed},!0),t.$watchCollection("infoTab",function(e,s){3===s&&3!==e&&(a.userId=i.user.id,t.isMe=!0,t.profileTab=0)}),t.isMe=!0,t.openProfile=function(e){s("right").open(),t.swiped=!1,a.userId=e,t.isMe=e===i.user.id?!0:!1,t.infoTab=3,t.profileTab=0},t.setInfoTab=function(a){t.infoTab=a},t.profileTab=0,t.setProfileTab=function(a){t.profileTab=a},t.next=function(){t.profileTab=Math.min(t.profileTab+1,2)},t.previous=function(){t.profileTab=Math.max(t.profileTab-1,0)},t.logout=function(){i.logout(function(){""!==localStorage.getItem("password")&&(localStorage.removeItem("password"),localStorage.removeItem("username"))}),a.load.signed=!1,t.infoTab=2},t.swiped=!1,t.swipe=function(){t.swiped=t.swiped===!0?!1:!0},t.toggleLeft=function(){s("left").toggle()},t.toggleRight=function(){s("right").toggle()}}]).controller("LeftCtrl",["$scope","$timeout","$mdSidenav",function(t,a,e){t.close=function(){e("left").close()}}]).controller("RightCtrl",["$scope","$timeout","$mdSidenav",function(t,a,e){t.close=function(){e("right").close()}}]);var app=angular.module("trigger");app.config(["$translateProvider",function(t){t.translations("en",{loginUsername:"Username",loginPassword:"Password",loginSubmit:"Yarrr!",consoleLogIn:"Log in",consoleListeners:"Listeners",consoleActiveUsers:"Active users",consoleYouCanUpload:"You can upload",consoleDonateMe:"Donate",consoleChangeTheme:"Change theme",consoleRTFM:"RTFM",consoleLogOut:"Log out",infoTabChat:"Chat",infoTabHistory:"History",infoTabDemocracy:"Democracy",infoTabProfile:"Profile",democracyElections:"Elections",democracyCandidate:"Candidate ID",democracyVoted:"You voted for",democracyVote:"Vote",democracyTabModer:"Moder",democracyTabBlog:"Blogs",startTyping:"type your message here...",chatBold:"bold",chatIrony:"irony",chatTink:"tink",chatImg:"images",onlineHere:"Here",historyGold:"gold",historyArtist:"Artist",historyTitle:"Title",historyNoResults:"No results ):",trackUploadedBy:"uploaded by",trackToChat:"send to chat",profileUser:"User",profileUploads:"Uploads",profilePluses:"Pluses",profileMinuses:"Minuses",profileSettings:"Settings",userBan:"Ban",userIgnore:"Ignore",userInvitedBy:"Invited by",userInvite:"Invited",userRegDate:"Registered",settingsLogOut:"Log out",settingsTink:"Tink",settingsImg:"Show images",settingsFemale:"Yahooo! I am woman",settingsOldPassword:"Old password",settingsNewPassword:"New password",settingsNewPasswordAgain:"Type new password again",settingsNewPasswordSumbit:"Change password!"}),t.translations("ru",{loginUsername:"Логин",loginPassword:"Пароль",loginSubmit:"Трям!",consoleLogIn:"Войти",consoleListeners:"Слушают",consoleActiveUsers:"из них активно",consoleYouCanUpload:"Ты можешь залить",consoleDonateMe:"Жертвенник",consoleChangeTheme:"Сделать день",consoleRTFM:"Мануал",consoleLogOut:"Выйти",infoTabChat:"Чат",infoTabHistory:"История",infoTabDemocracy:"Демократия",infoTabProfile:"Профиль",democracyElections:"Выборы",democracyCandidate:"ID кандидата",democracyVoted:"Ты проголосовал за",democracyVote:"Голосовать",democracyTabModer:"Модер",democracyTabBlog:"Блоги",startTyping:"начинай вводить...",chatBold:"bold",chatIrony:"irony",chatTink:"тиньк",chatImg:"картинки",onlineHere:"Здесь",historyGold:"Золото",historyArtist:"Исполнитель",historyTitle:"Трек",historyNoResults:"Нет результатов",trackUploadedBy:"прнс",trackToChat:"в чат",profileUser:"Юзер",profileUploads:"Загрузки",profilePluses:"Плюсы",profileMinuses:"Минусы",profileSettings:"Настройки",userBan:"Забанить",userIgnore:"ОМММ",userInvitedBy:"По приглашению",userInvite:"Понаприглашал",userRegDate:"С нами с",settingsLogOut:"Выйти",settingsTink:"Тинькать",settingsImg:"Показывать картинки",settingsFemale:"Ура, я женщина!",settingsOldPassword:"Старый пароль",settingsNewPassword:"Новый пароль",settingsNewPasswordAgain:"Новый пароль еще раз",settingsNewPasswordSumbit:"Я понимаю что делаю!"}),t.translations("he",{loginUsername:"שם משתמש",loginPassword:"סיסמא",loginSubmit:"שלח!",consoleLogIn:"התחבר",consoleListeners:"מאזינים",consoleActiveUsers:"משתמשים פעילים",consoleYouCanUpload:"אתה כרגע יכול להעלות ",consoleDonateMe:"לתרום לפיתוח",consoleChangeTheme:"שנה ",consoleRTFM:"RTFM",consoleLogOut:"צא",infoTabChat:"צ'אט",infoTabHistory:"היסטוריה",infoTabDemocracy:"דמוקרטיה",infoTabProfile:"פרופיל",democracyElections:"בחירות",democracyCandidate:"ID המועמד",democracyVoted:"בחרתם ב",democracyVote:"בחר",democracyTabModer:"מנהל",democracyTabBlog:"בלוג",startTyping:"תרשום פה...",chatBold:"bold",chatIrony:"irony",chatTink:"צליל התראה",chatImg:"תמונות",onlineHere:"פה כרגע",historyGold:"זהב",historyArtist:"שם האומן",historyTitle:"שם הטראק",historyNoResults:"אין תוצאות ):",trackUploadedBy:'הועלה ע"י" ',trackToChat:"שלח לצ'אט",profileUser:"שם משתמש",profileUploads:"העלאות",profilePluses:"חיוביים",profileMinuses:"שליליים",profileSettings:"הגדרות",userBan:"חסום",userIgnore:"התעלם",userInvitedBy:'הוזמן ע"י"',userInvite:"הוזמן",userRegDate:"רשום",settingsLogOut:"צא",settingsTink:"צליל התראה",settingsImg:"תראה תמונות",settingsFemale:"יששש! אני בחורה",settingsOldPassword:"סיסמא ישנה",settingsNewPassword:"סיסמא חדשה",settingsNewPasswordAgain:"עוד הפעם , סיסמא חדשה",settingsNewPasswordSumbit:"שנה סיסמא!"}),t.registerAvailableLanguageKeys(["en","ru"],{en_US:"en",en_UK:"en",ru_RU:"ru"}),t.preferredLanguage("en"),t.fallbackLanguage("en")}]);var app=angular.module("trigger");app.service("Client",function(){this.version=2205,this.user=null,this.channel={},this.callbacks={},this.chat=null,this.trackscache=[],this.init=function(){console.log("init"),this.socket=io("http://trigger.fm");var t=this.socket,a=this;t.on("getver",function(){t.emit("ver",{v:a.version,init:!0})}),t.on("history",function(t){a.callbacks.history(t)}),t.on("channelsdata",function(t){console.log(t),a.channels=t.channels,a.callbacks.channelsdata(t)}),t.on("userdata",function(t){a.callbacks.userdata(t)}),t.on("uvd",function(t){a.callbacks.uvotedata(t)}),t.on("invitestatus",function(t){a.callbacks.invitestatus(t)}),t.on("recoverstatus",function(t){a.callbacks.recover(t)}),t.on("changepass",function(t){a.callbacks.changepass(t)}),t.on("playlist",function(t){a.callbacks.playlist(t)}),t.on("loginstatus",function(t){t.error?("nouser"===t.error&&(t.error="Нет такого пользователя"),"wrongpass"===t.error&&(t.error="Не тот пароль")):(a.user=t.user,a.user.t<0&&(a.user.t=0),a.user.nt=new Date(Date.parse(new Date)+a.user.nt)),a.callbacks.loginstatus(t)}),t.on("disconnect",function(t){console.log("disconnect",t),a.user=null,a.channel={},a.callbacks={},a.chat=null}),t.on("tags",function(t){a.callbacks.tags(t.t)})},this.login=function(t,a,e){var s=this;s.callbacks.loginstatus=e,this.socket.emit("login",{u:t,p:a})},this.track=function(t,a){var e=this,s=!1;if(t===e.channel.current.id){if(!a)return e.channel.current;a(e.channel.current),s=!0}for(var n in e.channel.pls)if(e.channel.pls[n].id===t){if(!a)return e.channel.pls[n];a(e.channel.pls[n]),s=!0}!s&&a&&this.socket.emit("gettrack",{id:t},function(t){a(t)})},this.getPlaylist=function(t,a){var e=this;e.callbacks.playlist=a,this.socket.emit("getplaylist",{id:t})},this.goChannel=function(t,a){var e=this;e.callbacks.channeldata=a,this.socket.emit("gochannel",{id:t})},this.getChannels=function(t){var a=this;a.callbacks.channelsdata=t,this.socket.emit("getchannels")},this.tracksubmit=function(t,a){var e=t.form;this.socket.emit("tracksubmit",{chid:this.channel.id,track:t.track},function(t){t.form=e,console.log("data.form: ",t.form),a(t)})},this.adduservote=function(t,a){this.user&&(this.callbacks.uvotedata=a,this.socket.emit("uvote",t))},this.getUser=function(t,a){this.socket.emit("getuser",t,a)},this.getTags=function(t,a){var e=this;e.callbacks.tags=a,this.socket.emit("gettags",{s:t})},this.getTrackTags=function(t,a,e){var s=this;s.callbacks.tags=e,this.socket.emit("gettags",{a:t,t:a})},this.addTag=function(t,a){var e=this;e.callbacks.tags=a,this.socket.emit("addtag",{s:t})},this.killtrack=function(t){var a=this;this.socket.emit("deltrack",{tid:t,chid:a.channel.chid})},this.sendinvite=function(t,a,e){var s=this;s.callbacks.invitestatus=e,this.socket.emit("sendinvite",{m:t,c:a})},this.sendextinvite=function(t,a){this.socket.emit("sendextinvite",t,a)},this.logout=function(t){this.socket.emit("logout",{s:!0},t)},this.recover=function(t,a){var e=this;e.callbacks.recover=a,this.socket.emit("recover",{m:t})},this.changepass=function(t,a,e){var s=this;s.callbacks.changepass=e,this.socket.emit("changepass",{o:t,n:a})},this.updateUserData=function(t){this.socket.emit("upduserdata",t)},this.updateTrack=function(t){this.socket.emit("updtrack",t)},this.getchannel=function(t){for(var a in this.channels)if(this.channels[a].id===t)return this.channels[a];return!1},this.banuser=function(t,a,e){console.log(a),this.socket.emit("banuser",{id:t,r:a},e)},this.unbanuser=function(t,a){this.socket.emit("unbanuser",{id:t},a)},this.setop=function(t,a){this.socket.emit("setop",t,a)},this.removeop=function(t,a){this.socket.emit("removeop",t,a)},this.setprops=function(t,a){this.socket.emit("setprops",t,a)},this.sendPRVote=function(t,a){this.socket.emit("prvote",t,a)}});var app=angular.module("trigger");app.filter("readableTime",function(){return function(t){var a,e,s,t=parseInt(t,10);switch(!1){case!(60>t):s=t;break;case!(3600>t):e=~~(t/60),s=t%60;break;default:a=~~(t/3600),e=~~(t%3600/60),s=t%60}var n="";return a>0&&(n+=""+a+":"+(10>e?"0":"")),n+=e>0?""+e+":"+(10>s?"0":""):"0:",n+=""+s}});var app=angular.module("trigger");app.factory("socket",["$rootScope",function(t){var a=io.connect("http://trigger.fm");return{on:function(e,s){a.on(e,function(){var e=arguments;t.$apply(function(){s.apply(a,e)})})},emit:function(e,s,n){a.emit(e,s,function(){var e=arguments;t.$apply(function(){n&&n.apply(a,e)})})}}}]);var app=angular.module("trigger");app.factory("md5",function(){var t={createHash:function(t){var a,e,s,n,i,o,r,c,l,d,g=function(t,a){return t<<a|t>>>32-a},u=function(t,a){var e,s,n,i,o;return n=2147483648&t,i=2147483648&a,e=1073741824&t,s=1073741824&a,o=(1073741823&t)+(1073741823&a),e&s?2147483648^o^n^i:e|s?1073741824&o?3221225472^o^n^i:1073741824^o^n^i:o^n^i},m=function(t,a,e){return t&a|~t&e},p=function(t,a,e){return t&e|a&~e},k=function(t,a,e){return t^a^e},h=function(t,a,e){return a^(t|~e)},_=function(t,a,e,s,n,i,o){return t=u(t,u(u(m(a,e,s),n),o)),u(g(t,i),a)},v=function(t,a,e,s,n,i,o){return t=u(t,u(u(p(a,e,s),n),o)),u(g(t,i),a)},f=function(t,a,e,s,n,i,o){return t=u(t,u(u(k(a,e,s),n),o)),u(g(t,i),a)},b=function(t,a,e,s,n,i,o){return t=u(t,u(u(h(a,e,s),n),o)),u(g(t,i),a)},w=function(t){for(var a,e=t.length,s=e+8,n=(s-s%64)/64,i=16*(n+1),o=new Array(i-1),r=0,c=0;e>c;)a=(c-c%4)/4,r=c%4*8,o[a]=o[a]|t.charCodeAt(c)<<r,c+=1;return a=(c-c%4)/4,r=c%4*8,o[a]=o[a]|128<<r,o[i-2]=e<<3,o[i-1]=e>>>29,o
},y=function(t){var a,e,s="",n="";for(e=0;3>=e;e+=1)a=t>>>8*e&255,n="0"+a.toString(16),s+=n.substr(n.length-2,2);return s},T=[],C=7,I=12,P=17,x=22,$=5,M=9,S=14,U=20,D=4,L=11,A=16,B=23,O=6,z=10,N=15,R=21;for(T=w(t),r=1732584193,c=4023233417,l=2562383102,d=271733878,a=T.length,e=0;a>e;e+=16)s=r,n=c,i=l,o=d,r=_(r,c,l,d,T[e+0],C,3614090360),d=_(d,r,c,l,T[e+1],I,3905402710),l=_(l,d,r,c,T[e+2],P,606105819),c=_(c,l,d,r,T[e+3],x,3250441966),r=_(r,c,l,d,T[e+4],C,4118548399),d=_(d,r,c,l,T[e+5],I,1200080426),l=_(l,d,r,c,T[e+6],P,2821735955),c=_(c,l,d,r,T[e+7],x,4249261313),r=_(r,c,l,d,T[e+8],C,1770035416),d=_(d,r,c,l,T[e+9],I,2336552879),l=_(l,d,r,c,T[e+10],P,4294925233),c=_(c,l,d,r,T[e+11],x,2304563134),r=_(r,c,l,d,T[e+12],C,1804603682),d=_(d,r,c,l,T[e+13],I,4254626195),l=_(l,d,r,c,T[e+14],P,2792965006),c=_(c,l,d,r,T[e+15],x,1236535329),r=v(r,c,l,d,T[e+1],$,4129170786),d=v(d,r,c,l,T[e+6],M,3225465664),l=v(l,d,r,c,T[e+11],S,643717713),c=v(c,l,d,r,T[e+0],U,3921069994),r=v(r,c,l,d,T[e+5],$,3593408605),d=v(d,r,c,l,T[e+10],M,38016083),l=v(l,d,r,c,T[e+15],S,3634488961),c=v(c,l,d,r,T[e+4],U,3889429448),r=v(r,c,l,d,T[e+9],$,568446438),d=v(d,r,c,l,T[e+14],M,3275163606),l=v(l,d,r,c,T[e+3],S,4107603335),c=v(c,l,d,r,T[e+8],U,1163531501),r=v(r,c,l,d,T[e+13],$,2850285829),d=v(d,r,c,l,T[e+2],M,4243563512),l=v(l,d,r,c,T[e+7],S,1735328473),c=v(c,l,d,r,T[e+12],U,2368359562),r=f(r,c,l,d,T[e+5],D,4294588738),d=f(d,r,c,l,T[e+8],L,2272392833),l=f(l,d,r,c,T[e+11],A,1839030562),c=f(c,l,d,r,T[e+14],B,4259657740),r=f(r,c,l,d,T[e+1],D,2763975236),d=f(d,r,c,l,T[e+4],L,1272893353),l=f(l,d,r,c,T[e+7],A,4139469664),c=f(c,l,d,r,T[e+10],B,3200236656),r=f(r,c,l,d,T[e+13],D,681279174),d=f(d,r,c,l,T[e+0],L,3936430074),l=f(l,d,r,c,T[e+3],A,3572445317),c=f(c,l,d,r,T[e+6],B,76029189),r=f(r,c,l,d,T[e+9],D,3654602809),d=f(d,r,c,l,T[e+12],L,3873151461),l=f(l,d,r,c,T[e+15],A,530742520),c=f(c,l,d,r,T[e+2],B,3299628645),r=b(r,c,l,d,T[e+0],O,4096336452),d=b(d,r,c,l,T[e+7],z,1126891415),l=b(l,d,r,c,T[e+14],N,2878612391),c=b(c,l,d,r,T[e+5],R,4237533241),r=b(r,c,l,d,T[e+12],O,1700485571),d=b(d,r,c,l,T[e+3],z,2399980690),l=b(l,d,r,c,T[e+10],N,4293915773),c=b(c,l,d,r,T[e+1],R,2240044497),r=b(r,c,l,d,T[e+8],O,1873313359),d=b(d,r,c,l,T[e+15],z,4264355552),l=b(l,d,r,c,T[e+6],N,2734768916),c=b(c,l,d,r,T[e+13],R,1309151649),r=b(r,c,l,d,T[e+4],O,4149444226),d=b(d,r,c,l,T[e+11],z,3174756917),l=b(l,d,r,c,T[e+2],N,718787259),c=b(c,l,d,r,T[e+9],R,3951481745),r=u(r,s),c=u(c,n),l=u(l,i),d=u(d,o);var F=y(r)+y(c)+y(l)+y(d);return F.toLowerCase()}};return t});var app=angular.module("trigger");app.factory("User",["socket","Client",function(t,a){function e(t){console.log("processLogin",t),t.error?n.data=t:(n.data=t,s=t.user.t,r=t.user.id,o=t.user.n,c=t.user.w,i=!0)}var s,n={},i=!1,o="%username%",r=0,c=0;return t.on("uplim",function(t){s=t.t}),n.login=function(t,s){a.login(t,s,e)},n.isAuth=function(){return i},n.getLimit=function(){return s},n.getId=function(){return r},n.getUsername=function(){return o},n.getUservote=function(){return c},n.getData=function(){return n.data},n}]);var app=angular.module("trigger");app.factory("Channel",["socket","Client",function(t,a){var e={},s="",n=[];return t.on("welcome",function(t){console.log("welcome",t),a.getChannels(function(t){n=t.channels[0].users,a.goChannel(1,s=t.channels[0].description)})}),e.setData=function(t){e=t},t.on("channeldata",function(t){console.log("channeldata",t),e.setData(t)}),e.getId=function(){return e.chid},e.getProgress=function(){return e.ct},e.getDescription=function(){return s},e.getActiveUsers=function(){return e.a},e.getListeners=function(){return e.lst},t.on("lst",function(t){e.lst=t.l,e.a=t.a}),e.getUsers=function(){return n},e.getCurrent=function(){return e.current},e.getPlaylist=function(){return e.pls},e}]);var app=angular.module("trigger");app.directive("ngEnter",function(){return function(t,a,e){a.bind("keydown keypress",function(a){13===a.which&&(t.$apply(function(){t.$eval(e.ngEnter,{event:a})}),a.preventDefault())})}});var app=angular.module("trigger");app.directive("lastfmImg",["$rootScope","$http",function(){return{restrict:"A",scope:{ngSrc:"@",lastfmImg:"@"},link:function(t,a,e){e.$observe("lastfmImg",function(t){var e=t.split(",");if(void 0!==e[0]&&e[0].length>0){var s=new XMLHttpRequest;s.open("GET","http://ws.audioscrobbler.com/2.0/?method=track.getInfo&api_key=4366bdedfe39171be1b5581b52ddee90&artist="+e[1]+"&track="+e[0]+"&autocorrect=1&format=json",!0),s.onload=function(){if(s.status>=200&&s.status<400){var t=JSON.parse(s.responseText);if(void 0!==t.track)if(void 0!==t.track.album)void 0!==t.track.album.image[1]["#text"]&&a.attr("src",t.track.album.image[1]["#text"]);else{var n=new XMLHttpRequest;n.open("GET","http://ws.audioscrobbler.com/2.0/?method=artist.getinfo&api_key=4366bdedfe39171be1b5581b52ddee90&artist="+e[1]+"&autocorrect=1&format=json",!0),n.onload=function(){if(n.status>=200&&n.status<400){var t=JSON.parse(n.responseText);void 0!==t.artist&&void 0!==t.artist.image[1]["#text"]&&a.attr("src",t.artist.image[1]["#text"])}},n.onerror=function(){},n.send()}}},s.onerror=function(){},s.send()}})}}}]);var app=angular.module("trigger");app.directive("greeting",["$interval","$translate",function(t,a){return{restrict:"AE",link:function(e,s){var n=a.preferredLanguage(),i={ru:["А ты тоже ждешь 80 порт как и я, username?","Тыц-тыц, username, унц-унц, username!","Когда–то инвайт давали за +11, username.","Не бери треки у наркоманов, username!","Не всё то чилл, что уныло, username!","Не весь метал одинаково полезен, username!","Это не баян, это ротация, username"],en:["Let's dance, username?","Let's do lunch sometime, username","I've been there., username","Do you hear me, username?"],he:["Lol, username"]},o=i[n][Math.floor(Math.random()*i[n].length)].replace("username",e.user.name);s.html(o),t(function(){o=i[n][Math.floor(Math.random()*i[n].length)].replace("username",e.user.name),s.html(o)},9e3)}}}]);var app=angular.module("trigger");app.directive("compile",["$compile",function(t){return function(a,e,s){a.$watch(function(t){return t.$eval(s.compile)},function(s){e.html(s),t(e.contents())(a)})}}]),angular.module("trigger").run(["$templateCache",function(t){t.put("app/_jade/_track.html",'<div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div>'),t.put("app/_jade/_trackList.html",'<md-content class="history__content"><md-list class="playlist__list"><md-list class="playlist__list"><md-item ng-repeat="track in tracks | orderBy:\'tt\':true" class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><span class="track__rating">{{ track.r }}/</span><span class="track__voters-diff">{{ track.p.length - track.n.length }}</span></div></md-item></md-list><md-button ng-click="loadMore()" ng-show="tracks.length &gt; 0" aria-label="history--loadmore" class="history__loadmore">Load more</md-button></md-list></md-content>'),t.put("components/app/app.html",'<div ng-controller="AppCtrl" class="viewport--H"><section class="viewport--H"><md-sidenav md-component-id="left" md-is-locked-open="$mdMedia(\'min-width: 600px\')" class="md-sidenav-left md-whiteframe-z2"><md-toolbar class="console__switcher-cont"><svg id="audioBtn" ng-click="togglePlay()" ng-class="{ \'play\': play }" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 850.4 595.3" enable-background="new 0 0 850.4 595.3" xml:space="preserve" class="switcher"><path fill="none" stroke="#B4B4B4" stroke-width="55.3274" stroke-miterlimit="10" d="M154.7,568.2c-149-149-149-392.1,0-541.1" class="b3"></path><path fill="none" stroke="#9D9D9D" stroke-width="55.3274" stroke-miterlimit="10" d="M239,483.9C135.1,380,135.1,213.3,239,109.4" class="b2"></path><path fill="none" stroke="#7F7F7F" stroke-width="55.3274" stroke-miterlimit="10" d="M323.3,399.6c-56.9-56.9-56.9-149,0-205.8" class="b1"></path><circle fill="#7F7F7F" cx="425.2" cy="297.6" r="58.8" class="c"></circle><path fill="none" stroke="#7F7F7F" stroke-width="55.3274" stroke-miterlimit="10" d="M527.1,195.7c56.9,56.9,56.9,149,0,205.8" class="b1"></path><path fill="none" stroke="#9D9D9D" stroke-width="55.3274" stroke-miterlimit="10" d="M611.4,111.4c103.9,103.9,103.9,270.5,0,374.4" class="b2"></path><path fill="none" stroke="#B4B4B4" stroke-width="55.3274" stroke-miterlimit="10" d="M695.7,27.1c149,149,149,392.1,0,541.1" class="b3"></path></svg></md-toolbar><md-content ng-controller="LeftCtrl" class="console__ctrl"><div ng-include="\'components/console/console.html\'" class="console"></div></md-content></md-sidenav><div ng-include="\'components/playlist/playlist.html\'" class="playlist"></div><md-sidenav md-component-id="right" md-is-locked-open="$mdMedia(\'min-width: 960px\')" class="md-sidenav-right md-whiteframe-z2"><md-content ng-controller="RightCtrl" class="h"><div ng-include="\'components/info/info.html\'" class="h info"></div></md-content></md-sidenav></section></div>'),t.put("components/chat/chat.html",'<div ng-controller="ChatCtrl" ng-class="{ \'chat__module--extended\': isChatExtended === true }" class="chat__module"><md-content scroll-glue="" class="chat__md-content"><md-button ng-click="loadMore()" aria-label="chat--loadmore" class="chat__loadmore">Load more</md-button><md-list class="chat__list"><md-item ng-repeat="msg in messages" class="chat__list-item"><md-item-content class="chat__item"><div ng-class="{ \'private\': msg.pm, \'personal\': msg.type }" class="md-tile-content"><span ng-click="addNick(msg.uname)" class="msg__author">{{msg.uname}}:</span><span compile="msg.m" class="msg__message"></span><span am-time-ago="msg.t" class="msg__time"></span></div></md-item-content></md-item></md-list></md-content><md-button ng-class="{ \'chat__show-online--open\': showOnline }" ng-click="setOnline()" aria-label="chat-show-online" class="chat__show-online"><ng-md-icon icon="keyboard_arrow_left" size="24"></ng-md-icon></md-button><div ng-include="\'components/online/online.html\'" ng-class="{ \'online__include--open\': showOnline }" class="online__include"></div><div class="chat__input-grp"><md-input-container><label>{{ \'startTyping\' | translate }}</label> <textarea id="chatInput" ng-enter="sendMessage()" ng-change="checkMessage()" ng-model="message" columns="3" md-maxlength="700" autofocus="autofocus" class="chat__input"></textarea><div class="chat__input-nav"><md-button ng-click="setBold()" aria-label="chat-bold" class="chat__button--bold">{{ \'chatBold\' | translate }}</md-button><md-button ng-click="setIrony()" aria-label="chat-irony" class="chat__button--irony">{{ \'chatIrony\' | translate }}</md-button><md-checkbox ng-model="settings.tink" ng-change="setTink()" class="chat__checkbox--tink">{{ \'chatTink\' | translate }}</md-checkbox><md-checkbox ng-model="settings.img" ng-change="setImg()" class="chat__checkbox--img">{{ \'chatImg\' | translate }}</md-checkbox></div></md-input-container></div></div>'),t.put("components/console/console.html",'<md-toolbar ng-controller="ConsoleCtrl" class="console__include"><md-slider ng-model="volume" ng-change="changeVolume(volume)" min="0" max="100" step="1" aria-label="volume-slider"></md-slider><img ng-src="assets/images/logo.png" ng-click="data()" class="console__logo"><md-button ng-show="!load.signed" ng-click="showLoginModal($event)" aria-label="console-login" class="console__login-btn">{{ \'consoleLogIn\' | translate }}</md-button><p class="console__stat">{{ \'consoleListeners\' | translate }}:&nbsp;<span class="console__listeners">{{ users.listeners }}</span><br>{{ \'consoleActiveUsers\' | translate }}:&nbsp;<span class="console__active-users">{{ users.active }}</span></p><md-button ng-click="openUploadBar($event)" aria-label="uploader-btn" class="console__buttton--upload"><ng-md-icon icon="file_upload" size="24"></ng-md-icon></md-button><p ng-show="load.signed" class="console__user-limit">{{ \'consoleYouCanUpload\' | translate }}&nbsp;<time class="console__limit">{{ user.uplim | readableTime }}</time></p><p class="console__links"><a ng-click="changeTheme()" class="console__link">{{ \'consoleChangeTheme\' | translate }}</a></p><md-button ng-show="load.signed" ng-click="logout()" aria-label="console-logout" class="console__login-btn">{{ \'consoleLogOut\' | translate }}</md-button><blockquote class="muzoblob__blockquote"><p greeting="" class="console__greating"></p></blockquote><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="200pt" height="200pt" viewbox="0 0 200 200" preserveaspectratio="xMidYMid meet" class="muzoblob"><g transform="translate(-130,200) scale(0.1,-0.1)" fill="#000" stroke="none"><path d="M515 1986 c-21 -15 -25 -67 -5 -90 7 -9 25 -16 41 -16 l29 0 0 -129 c0 -91 4 -139 15 -164 l15 -36 -53 -53 c-64 -67 -134 -187 -159 -276 -22 -78 -48 -295 -48 -402 0 -69 -25 -222 -48 -297 -15 -48 -71 -149 -96 -172 -12 -11 -58 -38 -103 -60 -83 -41 -103 -61 -103 -104 0 -59 84 -77 200 -43 84 25 100 22 100 -16 0 -18 -4 -39 -9 -47 -14 -22 -2 -40 36 -56 56 -23 115 -18 231 21 59 20 124 37 144 37 24 0 66 -15 115 -39 76 -38 81 -39 183 -39 102 0 107 1 183 39 96 48 121 48 261 2 119 -39 174 -44 229 -21 43 18 48 31 29 72 -29 62 0 76 98 47 116 -34 200 -16 200 43 0 43 -20 63 -103 104 -45 22 -91 49 -103 60 -25 23 -81 124 -96 172 -23 75 -48 228 -48 297 0 107 -26 324 -48 402 -25 89 -95 209 -159 275 -49 51 -51 56 -40 81 6 15 14 85 17 157 5 120 7 130 25 133 51 10 73 72 37 105 -24 22 -76 22 -93 0 -11 -12 -14 -54 -15 -167 0 -124 -3 -157 -18 -184 -16 -32 -18 -33 -39 -18 -31 22 -104 55 -162 74 -68 21 -242 21 -310 0 -58 -19 -131 -52 -162 -74 -21 -15 -23 -14 -39 18 -17 30 -27 166 -24 307 1 60 -57 92 -105 57z m306 -862 c23 -11 29 -21 29 -46 0 -41 34 -94 73 -115 45 -23 131 -21 165 4 42 31 65 70 66 108 1 25 6 37 20 41 10 3 35 22 57 41 l38 34 12 -43 c9 -32 9 -56 0 -98 -11 -56 -59 -137 -79 -133 -6 2 -13 -6 -17 -16 -8 -25 -98 -63 -163 -69 -56 -5 -152 16 -131 28 8 5 5 10 -9 14 -11 4 -40 21 -63 39 -24 17 -48 32 -53 32 -5 0 -11 6 -14 14 -3 9 0 11 9 6 8 -5 11 -4 6 1 -5 5 -14 9 -19 9 -6 0 -13 6 -16 14 -3 9 0 11 8 6 8 -5 11 -3 9 4 -3 7 -9 12 -14 11 -14 -2 -23 36 -23 90 l1 45 8 -45 7 -45 0 55 c-1 85 -1 84 33 56 17 -15 44 -33 60 -42z"></path></g></svg></md-toolbar>'),t.put("components/democracy/democracy.html",'<div ng-controller="DemocracyCtrl" class="democracy__ctrl"><ng-switch on="data.selectedIndex" class="democracy__tabpanel-container"><div id="tabModerList-content" ng-switch-when="0" md-swipe-left="next()" md-swipe-right="previous()" role="tabpanel" aria-labelledby="tabModerList"><md-card class="democracy__list"><p>История работает (история плюсов, минусов и загрузок юзера тоже). Добавлена кнопка loadMore. Позже может быть сделаю автоподгрузку.<br>Если кликнуть на ник в чате - то ему можно отправить личное сообщение. Клики на юзеров в блоке "онлайн" тоже работают. История приватных сообщений не стирается при обновлении страницы. До тех пор, пока вы не закроете вкладку.<br>Можно слушать музыку! Клик на ту штуку в левом верхнем углу! У пользователей хрома могут быть проблемы, чуть позже заменю плеер.<br>В профиле можно менять пароль, смотреть кто отметился в карме, поменять аватарку.<br>Работает смена тем.<br>В чате работают кнопки болда, айрони, тиньки и фильтры картинок тоже. И да, теперь длина одного сообщения ограничена 240 символами. Смиритесь (:<br>ЦУП и все что там лежит не работает. Заливка треков не работает. И да, треки не раскрываются.<br>И да, можно уже попробовать открыть клиент на мобильнике! Ура.</p></md-card></div><div id="tabModerText-content" ng-switch-when="1" md-swipe-left="next()" md-swipe-right="previous()" role="tabpanel" aria-labelledby="tabModerText"><md-card class="democracy__list"><p ng-bind-html="description"></p></md-card></div></ng-switch><md-tabs md-selected="data.selectedIndex" class="md-accent"><md-tab id="ModerList" aria-controls="tabModerList-content"><span class="tabs__full">{{ \'democracyTabModer\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="account_balance" size="24"></ng-md-icon></span></md-tab><md-tab id="tabModerText" aria-controls="tabModerText-content"><span class="tabs__full">{{ \'democracyTabBlog\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="question_answer" size="24"></ng-md-icon></span></md-tab></md-tabs></div>'),t.put("components/history/history.html",'<div ng-controller="HistoryCtrl" class="history__module"><div class="history__search-grp"><md-checkbox ng-model="data.gold" ng-change="newHistory()" class="history__checkbox">{{ \'historyGold\' | translate }}</md-checkbox><md-checkbox ng-model="data.top" ng-change="newHistory()" class="history__checkbox">Top</md-checkbox><md-select ng-model="data.topType" ng-change="newHistory()" class="history__select"><md-option value="true">Votes</md-option><md-option value="false" ng-selected="selected">Rating</md-option></md-select><md-button ng-click="newHistory()" aria-label="Search-button" class="md-fab history--search-btn"><ng-md-icon icon="search" size="24"></ng-md-icon></md-button><md-input-container class="history--input"><label>{{ \'historyArtist\' | translate }}</label> <input ng-model="data.artist" type="text"></md-input-container><md-input-container class="history--input"><label>{{ \'historyTitle\' | translate }}</label> <input ng-model="data.title" ng-enter="newHistory()" type="text"></md-input-container></div><md-content class="history__content"><md-list class="playlist__list"><md-item ng-repeat="track in tracks | orderBy:\'tt\':true" ng-class="{ \'track--gold\': gold == true }" class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" alt="{{ track.t }} - {{ track.a }}" lastfm-img="{{ track.t }},{{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span am-time-ago="track.tt"></span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span am-time-ago="track.tt"></span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><span class="track__rating">{{ track.r }}/</span><span class="track__voters-diff">{{ track.p.length - track.n.length }}</span></div></md-item><md-button ng-click="loadMore()" ng-show="tracks.length &gt; 1" aria-label="history--loadmore" class="history__loadmore">Load more</md-button></md-list><div ng-show="tracks.length == 0" class="histroy--emtpy"><p class="history--empty-text"><ng-md-icon icon="adb" size="24"></ng-md-icon>{{ \'historyNoResults\' | translate }}</p></div></md-content></div>'),t.put("components/info/info.html",'<div class="infoTabs"><md-tabs md-selected="infoTab"><md-tab id="tabChat" md-on-select="setInfoTab(0)" ng-show="load.signed" aria-controls="tabChat-content"><md-tab-label><span class="tabs__full">{{ \'infoTabChat\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="chat" size="24"></ng-md-icon></span></md-tab-label><div ng-include="\'components/chat/chat.html\'" ng-show="load.signed" class="chat"></div></md-tab><md-tab id="tabHistory" md-on-select="setInfoTab(1)" aria-controls="tabHistory-content"><md-tab-label><span class="tabs__full">{{ \'infoTabHistory\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="history" size="24"></ng-md-icon></span></md-tab-label><div ng-include="\'components/history/history.html\'" class="history"></div></md-tab><md-tab id="tabDemocracy" md-on-select="setInfoTab(2)" aria-controls="tabDemocracy-content"><md-tab-label><span class="tabs__full">{{ \'infoTabDemocracy\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="whatshot" size="24"></ng-md-icon></span></md-tab-label><div ng-include="\'components/democracy/democracy.html\'" class="democracy__include"></div></md-tab><md-tab id="tabProfile" md-on-select="setInfoTab(3)" ng-show="load.signed" aria-controls="tabProfile-content"><md-tab-label><span class="tabs__full">{{ \'infoTabProfile\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="person" size="24"></ng-md-icon></span></md-tab-label><div ng-include="\'components/profile/profile.html\'" class="profile__include"></div></md-tab></md-tabs></div>'),t.put("components/login/login.html",'<md-dialog ng-controller="LoginCtrl" aria-label="login-modal" class="login__ctrl"><md-card class="login__card"><md-input-container class="login__username"><label>{{ \'loginUsername\' | translate }}</label> <input ng-model="user.name" type="text" autofocus="autofocus" inputmode="latin"></md-input-container><md-input-container class="login__username"><label>{{ \'loginPassword\' | translate }}</label> <input ng-model="user.password" ng-enter="login()" type="password" inputmode="latin"></md-input-container><div class="login__settings"><md-checkbox ng-model="user.remember" class="settings__remember">Remember me</md-checkbox></div><md-button ng-click="login()" aria-label="login--btn" class="login__btn">{{ \'loginSubmit\' | translate }}</md-button></md-card></md-dialog>'),t.put("components/minuses/minuses.html",'<div ng-controller="MinusesCtrl" class="minuses__ctrl"><md-content class="history__content"><md-list class="playlist__list"><md-list class="playlist__list"><md-item ng-repeat="track in tracks | orderBy:\'tt\':true" class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><span class="track__rating">{{ track.r }}/</span><span class="track__voters-diff">{{ track.p.length - track.n.length }}</span></div></md-item></md-list><md-button ng-click="loadMore()" ng-show="tracks.length &gt; 0" aria-label="history--loadmore" class="history__loadmore">Load more</md-button></md-list></md-content></div>'),t.put("components/online/online.html",'<div ng-controller="OnlineCtrl" class="online__ctrl"><p class="online__here">{{ \'onlineHere\' | translate }}:&nbsp;<span class="online__counter">{{ users.length }}</span></p><md-content class="online__md-content"><md-list class="online__list"><md-item ng-repeat="user in users" class="online__list-item"><md-item-content ng-class="{ active: user.a == true }" class="online__item"><md-button ng-click="openProfile(user.id)" aria-label="open-user-profile" class="user__2profile">i</md-button><md-button ng-click="addNick(user.n)" aria-label="add-user-to-chat" class="user__2chat">{{ user.n }}</md-button></md-item-content></md-item></md-list></md-content></div>'),t.put("components/playlist/playlist.html",'<div ng-controller="PlaylistCtrl" class="playlist__ctrl"><md-toolbar class="playlist__toolbar"><h2 class="md-toolbar-tools playlist__toolbar-tools"><md-button ng-click="toggleLeft()" aria-label="leftbar-switcher" class="playlist__leftbar-swither"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewbox="0 0 56 56" enable-background="new 0 0 56 56" xml:space="preserve" class="playlist__leftbar-svg"><path fill="none" stroke="#B4B4B4" stroke-width="3" stroke-miterlimit="10" d="M14.2,41.8c-7.6-7.6-7.6-20,0-27.6" class="b3"></path><path fill="none" stroke="#9D9D9D" stroke-width="3" stroke-miterlimit="10" d="M18.5,37.5c-5.3-5.3-5.3-13.8,0-19.1" class="b2"></path><path fill="none" stroke="#7F7F7F" stroke-width="3" stroke-miterlimit="10" d="M22.8,33.2c-2.9-2.9-2.9-7.6,0-10.5" class="b1"></path><circle fill="#7F7F7F" cx="28" cy="28" r="3" class="c"></circle><path fill="none" stroke="#7F7F7F" stroke-width="3" stroke-miterlimit="10" d="M33.2,22.8c2.9,2.9,2.9,7.6,0,10.5" class="b1"></path><path fill="none" stroke="#9D9D9D" stroke-width="3" stroke-miterlimit="10" d="M37.5,18.5c5.3,5.3,5.3,13.8,0,19.1" class="b2"></path><path fill="none" stroke="#B4B4B4" stroke-width="3" stroke-miterlimit="10" d="M41.8,14.2c7.6,7.6,7.6,20,0,27.6" class="b3"></path></svg></md-button>{{ channel }}<md-button ng-click="toggleRight()" aria-label="rightbar-switcher" class="playlist__rightbar-swither"><ng-md-icon icon="view_carousel" size="24"></ng-md-icon></md-button></h2></md-toolbar><md-content class="playlist__content--current"><md-list class="playlist__list"><md-item class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><md-button ng-click="voteDown(track.id)" aria-label="track-up" class="md-fab track__vote--down"><ng-md-icon icon="expand_more" size="24"></ng-md-icon></md-button><span class="track__rating">{{ track.r }}</span><md-button ng-click="voteUp(track.id)" aria-label="track-down" class="md-fab track__vote--up"><ng-md-icon icon="expand_less" size="24"></ng-md-icon></md-button></div><div class="track__progress"><div style="width:{{ progress }}%;" class="track__progress-active"></div></div></md-item></md-list></md-content><md-content scroll-glue="reverse" class="playlist__content"><md-list class="playlist__list"><md-item ng-repeat="track in playlist track by track.id" style="order: {{ reverse*100 - track.r }}" class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><md-button ng-click="voteDown(track.id)" aria-label="track-up" class="md-fab track__vote--down"><ng-md-icon icon="expand_more" size="24"></ng-md-icon></md-button><span class="track__rating">{{ track.r }}</span><md-button ng-click="voteUp(track.id)" aria-label="track-down" class="md-fab track__vote--up"><ng-md-icon icon="expand_less" size="24"></ng-md-icon></md-button></div></md-item><div ng-show="playlist.length &lt; 10" class="playlist--emtpy"><p class="playlist--empty-text"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="200pt" height="200pt" viewbox="0 0 200 200" preserveaspectratio="xMidYMid meet"><g transform="translate(0,200) scale(0.1,-0.1)" fill="#000000" stroke="none"><path d="M515 1986 c-21 -15 -25 -67 -5 -90 7 -9 25 -16 41 -16 l29 0 0 -129 c0 -91 4 -139 15 -164 l15 -36 -53 -53 c-64 -67 -134 -187 -159 -276 -22 -78 -48 -295 -48 -402 0 -69 -25 -222 -48 -297 -15 -48 -71 -149 -96 -172 -12 -11 -58 -38 -103 -60 -83 -41 -103 -61 -103 -104 0 -59 84 -77 200 -43 84 25 100 22 100 -16 0 -18 -4 -39 -9 -47 -14 -22 -2 -40 36 -56 56 -23 115 -18 231 21 59 20 124 37 144 37 24 0 66 -15 115 -39 76 -38 81 -39 183 -39 102 0 107 1 183 39 96 48 121 48 261 2 119 -39 174 -44 229 -21 43 18 48 31 29 72 -29 62 0 76 98 47 116 -34 200 -16 200 43 0 43 -20 63 -103 104 -45 22 -91 49 -103 60 -25 23 -81 124 -96 172 -23 75 -48 228 -48 297 0 107 -26 324 -48 402 -25 89 -95 209 -159 275 -49 51 -51 56 -40 81 6 15 14 85 17 157 5 120 7 130 25 133 51 10 73 72 37 105 -24 22 -76 22 -93 0 -11 -12 -14 -54 -15 -167 0 -124 -3 -157 -18 -184 -16 -32 -18 -33 -39 -18 -31 22 -104 55 -162 74 -68 21 -242 21 -310 0 -58 -19 -131 -52 -162 -74 -21 -15 -23 -14 -39 18 -17 30 -27 166 -24 307 1 60 -57 92 -105 57z m306 -862 c23 -11 29 -21 29 -46 0 -41 34 -94 73 -115 45 -23 131 -21 165 4 42 31 65 70 66 108 1 25 6 37 20 41 10 3 35 22 57 41 l38 34 12 -43 c9 -32 9 -56 0 -98 -11 -56 -59 -137 -79 -133 -6 2 -13 -6 -17 -16 -8 -25 -98 -63 -163 -69 -56 -5 -152 16 -131 28 8 5 5 10 -9 14 -11 4 -40 21 -63 39 -24 17 -48 32 -53 32 -5 0 -11 6 -14 14 -3 9 0 11 9 6 8 -5 11 -4 6 1 -5 5 -14 9 -19 9 -6 0 -13 6 -16 14 -3 9 0 11 8 6 8 -5 11 -3 9 4 -3 7 -9 12 -14 11 -14 -2 -23 36 -23 90 l1 45 8 -45 7 -45 0 55 c-1 85 -1 84 33 56 17 -15 44 -33 60 -42z"></path></g>Самое время нести!</svg></p></div></md-list></md-content></div>'),t.put("components/pluses/pluses.html",'<div ng-controller="PlusesCtrl" class="pluses__ctrl"><md-content class="history__content"><md-list class="playlist__list"><md-list class="playlist__list"><md-item ng-repeat="track in tracks | orderBy:\'tt\':true" class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><span class="track__rating">{{ track.r }}/</span><span class="track__voters-diff">{{ track.p.length - track.n.length }}</span></div></md-item></md-list><md-button ng-click="loadMore()" ng-show="tracks.length &gt; 0" aria-label="history--loadmore" class="history__loadmore">Load more</md-button></md-list></md-content></div>'),t.put("components/profile/profile.html",'<div class="profile__ctrl"><ng-switch on="profileTab" class="profile__tabpanel-container"><div id="tabUser-content" ng-switch-when="0" role="tabpanel" aria-labelledby="tabUser"><div ng-include="\'components/user/user.html\'" class="user__include h"></div></div><div id="tabUploads-content" ng-switch-when="1" role="tabpanel" aria-labelledby="tabUploads"><div ng-include="\'components/uploads/uploads.html\'" class="uploads__include"></div></div><div id="tabPluses-content" ng-switch-when="2" role="tabpanel" aria-labelledby="tabPluses"><div ng-include="\'components/pluses/pluses.html\'" class="pluses__include"></div></div><div id="tabMinuses-content" ng-switch-when="3" role="tabpanel" aria-labelledby="tabMinuses"><div ng-include="\'components/minuses/minuses.html\'" class="minuses__include"></div></div><div id="tabSettings-content" ng-switch-when="4" ng-show="isMe" role="tabpanel" aria-labelledby="tabSettings"><div ng-include="\'components/settings/settings.html\'" class="settings__include"></div></div></ng-switch><md-tabs md-selected="profileTab" md-stretch-tabs="never" class="md-accent"><md-tab id="tabUser" ng-click="setProfileTab(0)" aria-controls="tabUser-content"><span class="tabs__full">{{ \'profileUser\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="home" size="24"></ng-md-icon></span></md-tab><md-tab id="tabUploads" ng-click="setProfileTab(1)" aria-controls="tabUploads-content"><span class="tabs__full">{{ \'profileUploads\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="file_upload" size="24"></ng-md-icon></span></md-tab><md-tab id="tabPluses" ng-click="setProfileTab(2)" aria-controls="tabPluses-content"><span class="tabs__full">{{ \'profilePluses\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="thumb_up" size="24"></ng-md-icon></span></md-tab><md-tab id="tabMinuses" ng-click="setProfileTab(3)" aria-controls="tabMinuses-content"><span class="tabs__full">{{ \'profileMinuses\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="thumb_down" size="24"></ng-md-icon></span></md-tab><md-tab id="tabSettings" ng-click="setProfileTab(4)" ng-show="isMe" aria-controls="tabSettings-content"><span class="tabs__full">{{ \'profileSettings\' | translate }}</span><span class="tabs__icon"><ng-md-icon icon="settings" size="24"></ng-md-icon></span></md-tab></md-tabs></div>'),t.put("components/settings/settings.html",'<div ng-controller="SettingsCtrl" class="settings__ctrl"><md-card class="settings__card"><div class="settings__logout"><md-button aria-label="logout" class="settings__logout-btn">{{ \'settingsLogOut\' | translate }}</md-button><md-button ng-click="initLast()" aria-label="logout" class="settings__logout-btn">lastFM</md-button></div><div class="settings__chat"><md-checkbox ng-model="gender" ng-change="changeGender()" class="settings__female">{{ \'settingsFemale\' | translate }}</md-checkbox></div><div class="settings__password"><md-input-container class="settings__password--old"><label>{{ \'settingsOldPassword\' | translate }}</label> <input ng-model="oldPassword" aria-label="settings-old-password" inputmode="latin"></md-input-container><md-input-container class="settings__password--new"><label>{{ \'settingsNewPassword\' | translate }}</label> <input ng-model="newPassword" type="password" aria-label="settings-new-password" inputmode="latin"></md-input-container><md-input-container class="settings__password--new"><label>{{ \'settingsNewPasswordAgain\' | translate }}</label> <input ng-model="newPasswordFix" ng-enter="changePassword" type="password" inputmode="latin" aria-label="settings-new-password"></md-input-container><md-button ng-click="changePassword()" aria-label="change-password" class="settings__password-btn">{{ \'settingsNewPasswordSumbit\' | translate }}</md-button></div></md-card></div>'),t.put("components/upload/upload.html",'<md-bottom-sheet class="md-grid uploadbar"><md-button>Upload - Drag & Drop here!</md-button><md-list><md-item ng-repeat="item in items"><md-button ng-click="listItemClick($index)" aria-label="{{ item.name }}" class="md-grid-item-content"><div class="md-icon-container"><md-inline-grid-icon icon="{{ item.icon }}"></md-inline-grid-icon></div></md-button></md-item></md-list></md-bottom-sheet>'),t.put("components/user/user.html",'<div ng-controller="UserCtrl" class="user__ctrl h"><md-card ng-class="{ \'swiped\': swiped === true }" class="user__main h"><div class="user__swipe-cont user__swipe-cont--first"><md-content class="user__md-main"><div class="user__nav"><div class="user_names-block"><span class="user__name">{{ user.name }}</span><span class="user__id"># {{ user.id }}</span></div><div ng-class="{ \'voted--up\': user.vote == \'plus\', \'voted--down\': user.vote == \'minus\' }" class="user__votes-block"><md-button ng-click="userVoteDown(user.id)" ng-show="!isMe" aria-label="user-minus" class="md-fab user__vote--down"><ng-md-icon icon="expand_more" size="24"></ng-md-icon></md-button><span class="user__karma">{{ user.karma }}</span><md-button ng-click="userVoteUp(user.id)" ng-show="!isMe" aria-label="user-plus" class="md-fab user__vote--up"><ng-md-icon icon="expand_less" size="24"></ng-md-icon></md-button></div></div><div class="user__main"><figure ng-class="{ \'user__img-cont--edit\': edit === true, \'user__img-cont--save\': save === true }" class="user__img-cont"><img ng-src="{{ user.pic }}" alt="" class="user__img"><md-button ng-click="editAvatar()" ng-show="isMe" aria-label="user-plus" class="user__edit-avatar"><ng-md-icon icon="mode_edit" size="12"></ng-md-icon></md-button><md-button ng-click="saveAvatar()" ng-show="isMe" aria-label="user-plus" class="user__save-avatar"><ng-md-icon icon="save" size="24"></ng-md-icon></md-button><figcaption class="user__img-tooltip"><md-input-container class="user__img-input-container"><label class="user__img-input-label">URL of avatar:</label> <input ng-model="avatarUrl" type="url" inputmode="latin" aria-label="img-new-avatar" class="user__img-input"></md-input-container><md-button ng-click="previewAvatar()" ng-show="isMe" aria-label="user-plus" class="user__img-submit"><ng-md-icon icon="file_upload" size="24"></ng-md-icon></md-button></figcaption></figure><div class="user__additional"><p ng-bind-html="user.i" class="user__descripton"></p><p class="user__origin">{{ \'userRegDate\' | translate }}<span class="user__regdate">{{ user.reg | date:\'d.MM.y\' }}</span><span ng-show="user.invites.p.name" class="user__invitedby">{{ \'userInvitedBy\' | translate }} <button ng-click="openProfile(user.invites.p.id)" aria-label="user-origin" class="user__father">{{user.invites.p.name}}</button></span></p><p ng-show="user.invites.u.length" class="user__invited">{{ \'userInvite\' | translate }}<span ng-repeat="child in user.invites.u" class="user__children"><button ng-click="openProfile(child.id)" aria-label="user-child" class="user__child">{{ child.n }})</button></span></p></div></div><div class="user__control"><md-checkbox ng-model="data.img" aria-label="ОМММ" class="user__ignore">{{ \'userIgnore\' | translate }}</md-checkbox><md-button aria-label="user-ban" class="user__ban">{{ \'userBan\' | translate }}</md-button></div></md-content></div><div ng-click="swipe()" class="user__swiper"></div><div class="user__swipe-cont user__swipe-cont--second"><div style="flex: {{ user.n.length/(user.p.length+user.n.length) }}" class="user__relation"><h4 class="user__relations-header">Haters(<span class="user__relations-counter">{{ user.n.length }}):</span></h4><md-content class="user__md-content"><md-list class="user__list"><md-item ng-repeat="n in user.n" class="user__list-item"><md-item-content ng-class="{ active: user.a == true }" class="user__item"><md-button ng-click="openProfile(n.vid)" aria-label="open-user-profile" class="user__2profile">i</md-button><md-button ng-click="addNick(n.n)" aria-label="add-user-to-chat" class="user__2chat">{{ n.n.length && n.n || \'Deleted\' }}</md-button></md-item-content></md-item></md-list></md-content></div><div style="flex: {{ user.p.length/(user.p.length+user.n.length) }};" class="user__relation"><h4 class="user__relations-header">Lovers(<span class="user__relations-counter">{{ user.p.length }}):</span></h4><md-content class="user__md-content"><md-list class="user__list"><md-item ng-repeat="p in user.p" class="user__list-item"><md-item-content ng-class="{ active: user.a == true }" class="user__item"><md-button ng-click="openProfile(p.vid)" aria-label="open-user-profile" class="user__2profile">i</md-button><md-button ng-click="addNick(p.n)" aria-label="add-user-to-chat" class="user__2chat">{{ p.n.length && p.n || \'Deleted\' }}</md-button></md-item-content></md-item></md-list></md-content></div></div></md-card></div>'),t.put("components/uploads/uploads.html",'<div ng-controller="UploadsCtrl" class="uploads__ctrl"><md-content class="history__content"><md-list class="playlist__list"><md-list class="playlist__list"><md-item ng-repeat="track in tracks | orderBy:\'tt\':true" class="playlist__track"><div class="track__img-cont"><img ng-src="assets\\images\\nocover.png" lastfm-img="{{ track.t }},{{ track.a }}" alt="{{ track.t }} - {{ track.a }}" class="track__img"></div><div class="track__row"><div class="track__base"><div class="track__content"><h3 class="track__artist">{{ track.a }}</h3><h4 class="track__title">{{ track.t }}</h4></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div><div class="track__additional"><div class="track__content"><div class="track__links"><a href="http://vk.com/audio?q={{ track.t }}-{{ track.a }}" target="_blank" class="track__link">&nbsp;>vk</a><a href="http://www.lastfm.ru/search?q={{ track.t }}+{{ track.a }}" target="_blank" class="track__link">&nbsp;>lastfm</a><a ng-click="trackToChat(track.id)" class="track__link">&nbsp;>{{ \'trackToChat\' | translate }}</a></div><div class="track__upload-info">{{ \'trackUploadedBy\' | translate }}&nbsp;<a ng-click="openProfile(track.sid)">{{ track.s }}&nbsp;</a><span am-time-ago="track.ut"></span></div></div><div class="track__tags"><span ng-repeat="tag in track.tg" class="track__tag">{{ tag.n }}</span></div><div class="track__time"><span>+{{ track.tt | readableTime }}</span></div></div></div><div ng-class="{ \'voted--up\': track.vote &gt; 0, \'voted--down\': track.vote &lt; 0 }" ng-show="load.signed" class="track__votes-block"><span class="track__rating">{{ track.r }}/</span><span class="track__voters-diff">{{ track.p.length - track.n.length }}</span></div></md-item></md-list><md-button ng-click="loadMore()" ng-show="tracks.length &gt; 0" aria-label="history--loadmore" class="history__loadmore">Load more</md-button></md-list></md-content></div>')
}]);
